<style>
	.cards_wrapper {
		display: grid;
		grid-gap: 10px;
		grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
	}
	.card {
	}
</style>

<h3>Actions</h3>
<div class="cards_wrapper">
	<div class="card">
		<!-- TODO: width: auto; -->
		<input id="new_account"
		       autocomplete="off"
		       placeholder="Select an option first!"
		       maxlength="0"
		       style="display: none;"
		       onkeypress="registerNewAccount(event, this);" />
		<select id="account_select" onchange="selectAccount();">
			<option value="">New account</option>
			{% for account in supported_accounts %}
				<option value="{{ account.0 }}" maxlength="{{ account.1 }}">{{ account.0 }}</option>
			{% endfor %}
		</select>
	</div>
</div>

<h3>Accounts</h3>
<div class="cards_wrapper">
	{% for phone_number in phone_numbers %}
		<div class="card">
			<p><strong>{{ phone_number }}</strong></p>
		</div>
	{% endfor %}
</div>

<div class="cards_wrapper">
	{% for email_address in email_addresses %}
		<div class="card">
			<p><strong>{{ email_address }}</strong></p>
		</div>
	{% endfor %}
</div>


<script>
	function enterKeyPress(event) {
		if (event.keyCode !== 13) {
			return false;
		}
		return true;
	}

	function registerNewAccount(event, caller) {
		if (!enterKeyPress(event)) {
			// TODO: filter accounts
			return false;
		}
		if (caller.value === "") {
			caller.style.display = "none";
			document.getElementById("account_select").style.display = "";
			return false;
		}
		console.log("New account:", event.keyCode, "::", caller.value);
	}

	function selectAccount() {
		const select = document.getElementById("account_select");
		const selected_account = select.options[select.selectedIndex];
		if (selected_account.value !== "") {
			let new_account_input = document.getElementById("new_account");
			new_account_input.setAttribute("maxlength", selected_account.getAttribute("maxlength"));
			new_account_input.setAttribute("placeholder", selected_account.innerText);
			select.style.display = "none";
			new_account_input.style.display = "";
		}
	}

</script>
